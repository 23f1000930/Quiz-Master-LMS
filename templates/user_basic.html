{% extends 'basic.html' %}

{% block page_css %}
  <link rel="stylesheet" href="/static/user.css">
  {% block user_css %} {% endblock %}
{% endblock %}


{% block page_body %}

<!-- Sidebar -->
<div class="sidebar" id="sidebar">
    <a href="/user_home" id="uhome">
      <i class="bi bi-house-door"></i>
      <span>Home</span>
    </a>
    <a href="/user_subject" id="usub">
      <i class="bi bi-journals"></i>
      <span>Subjects</span>
    </a>
    <a href="/user_summary" id="usummary">
      <i class="bi bi-bar-chart-line"></i>
      <span>Summary</span>
    </a>
    <a href="/login">
      <i class="bi bi-box-arrow-right"></i>
      <span>Logout</span>
    </a>
    <a href="#" id="toggleSidebar">
      <i class="bi bi-chevron-double-right" id="toggleIcon"></i>
      <span>Collapse</span>
    </a>
  </div>
  
  {% block user_content %} {% endblock %}

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Get the current page URL
      let currentPage = window.location.pathname.split("/").pop();
        console.log("Current Page URL:", currentPage)
  
        // Map pages to button IDs
        const pageMap = {
          "user_home":"uhome",
          "user_subject":"usub",
          "user_summary":"usummary"
        };
  
        // If current page matches, add active state
        if (pageMap[currentPage]) {
          let activeButton = document.getElementById(pageMap[currentPage]);
          if (["uhome", "usub", "uscore", "usummary"].includes(activeButton.id)) {
            activeButton.style.background = "black"
            activeButton.style.color = "white"; // Active Effect
          }
  
        }
      const sidebar = document.getElementById("sidebar");
      const toggleButton = document.getElementById("toggleSidebar");
      const toggleIcon = document.getElementById("toggleIcon");
  
      // Unique storage key for home.html
      let storageKey = "sidebarExpanded_user_dashboard";
  
      // Check localStorage for previous sidebar state
      if (localStorage.getItem(storageKey) === "true") {
          sidebar.classList.add("expanded");
          toggleIcon.classList.remove("bi-chevron-double-right");
          toggleIcon.classList.add("bi-chevron-double-left");
      }
  
      // Toggle sidebar on button click
      toggleButton.addEventListener("click", function (event) {
          event.preventDefault();
          sidebar.classList.toggle("expanded");
  
          if (sidebar.classList.contains("expanded")) {
              toggleIcon.classList.remove("bi-chevron-double-right");
              toggleIcon.classList.add("bi-chevron-double-left");
              localStorage.setItem(storageKey, "true");
          } else {
              toggleIcon.classList.remove("bi-chevron-double-left");
              toggleIcon.classList.add("bi-chevron-double-right");
              localStorage.setItem(storageKey, "false");
          }
      });
    });
  </script>
{% endblock %}